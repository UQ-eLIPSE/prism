# Overview:
#
# To Run:
# ansible-playbook -i </path/to/inventory> <playbook>.yml

- name: Restore test Database
  hosts: zones
  any_errors_fatal: true

  tasks:
    - name: MongoDB restore on the remote Server
      command: |
        mongo prism_uat --eval "db.dropDatabase()"

    - name: MongoDB restore
      command: |
        mongorestore "prism_uat_v0"

    - name: Run Cypress on Github repo/client folder on the github VM
      shell: |
        cd {{ localdir_client }} && yarn
      delegate_to: localhost

    - name: Run spec Cypress test
      shell: |
        cd {{ localdir_client }} && yarn cypress:run:uat --spec cypress/e2e/DocumentationTest.cy.ts
      delegate_to: localhost
